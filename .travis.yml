sudo: false
language: cpp

addons:
 apt:
  packages:
   - qt5-qmake
   - clang-3.7

notifications: newer

os:
  - osx

compiler:
  - clang

before_install:
 - '[[ "$TRAVIS_OS_NAME" != "osx" ]] || brew update'

install:
 - '[[ "$TRAVIS_OS_NAME" != "osx" ]] || brew install qt5'
 - '[[ "$TRAVIS_OS_NAME" != "osx" ]] || brew link --force qt5'
 # clang 3.7
 - if [ "$CXX" == "clang++" ]; then export CXX="clang++-3.7"; fi
 - clang --version

script:
  - cd Tempest
  - qmake Tempest.pro -r -spec macx-clang CONFIG+=x86_64
  - make

deploy:
  provider: releases
  description: 'no release description'
  draft: true
  api_key:
    secure: dtg8DOMuN1r9tbvsFV6JVSOMMz79Zzojit9ed0O2ae7EbcSLgZsokL+exLIG2g//9/hG0fzsclMdEIMYNoqOcx+KOFF0EKKB3Ppnhqbmw34b3I+GCChgvjY99YkBK4zKvvFmmiIAmEr4cdyIvB5YFhQSKgdTLhjzqJcveZEUmO80BfUVvavEtC6LjF1mEnolOSpAjOW8vXuIoaB1+D0FFVU5WfjBC8bn2B/llmS47tPcVBOvCJwBshqmyMn283H5AxMt6a2/dYNZiIDbVFlAUopL74NhqgVzn34nrHdrBW5JzrXPDS6qn/8Tk2F3Aki5lIorGDHkufQEuPy4qs4iYnCvt9K4pj3/nO5PCXvymQIr8w4WOauhzYCJUOoXV+W1yV5BkKMeK5DNW7maYw1YD7hrmoHaFZBKwl4eTNisZVYOTxj4pdXqZOvCEu2B//60jvukZzUN118JpUlNc6Uza+QX2D0Oc9aHKOKVSPuh/HNtJz7doUI5U3jmsCTH12RM1WHbXic60j3IOHGBuNSMyUCofeoOXeWUH4wjfdcDaqhIUrTgUAxTUrHA5M1wPqumK+32gN0IsI8ikJeiYZCIhL2tWURXwXrtJTOVdtUDRQe1mnt90akMTxp3BI89PdNywyNK4g5cyXGD6poQAMLDI76JFnDJ2Kfuqfb6w2RWhL4=
  file:
    - "libTempest.dylib"

  skip_cleanup: true
  on:
    branch:
      - master
    tags: false
